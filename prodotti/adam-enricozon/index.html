<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Adam</title>
  <link rel="icon" href="/immagini/loghi/logo.jpeg" />
  <link rel="stylesheet" href="style.css" />
</head>

<body>
  <header>
    <a href="https://enricozon.mom">
      <img src="enricozon.png" />
    </a>
  </header>

  <div class="product-container">
    <div class="product-image-container">
      <img class="img1" src="adam.jpg" alt="Product Image" />
      <div class="product-ratings" id="ratingsContainer">
        <h2>Recensioni degli utenti</h2>
        <div class="rating">
          <p>Filippo Turetta: (10/10)</p>
          <p>Ottimo schiavo, lo consiglio a tutti!</p>
        </div>
        <br>
        <div class="rating">
          <p>Enriccio: (10/10)</p>
          <p>Ottimo prodotto!</p>
        </div>
        <br>
        <div class="rating">
          <p>Enriccio: (10/10)</p>
          <p>Ottimo prodotto!</p>
        </div>
        <br>
        <div class="rating">
          <p>Enriccio: (10/10)</p>
          <p>Ottimo prodotto!</p>
        </div>

        
      </div>
     
    </div>
    <div class="product-details">
      <h1>Adam il Nero</h1>
      <p><strong>Prezzo:</strong> $104.00</p>
      <a href="buy.html"><div class="buy-button">Buy Now</div></a>
      <div class="product-description">
        <h2>Descrizione del Prodotto</h2>
        <p>
          Adam il Nero, coltivatore e lavoratore professionista, può aiutarti
          in qualsiasi ambito, ma senza farlo arrabbiare.
        </p>
      </div>
      <div class="key-features">
        <h2>Benefici</h2>
        <ul>
          <li>È nero</li>
          <li>È bravo</li>
          <li>Fa il suo lavoro bene</li>
        </ul>
        <h2>Scrivi una recensione</h2>
        <button id="openFormButton" onclick="toggleForm()">Nuova Recensione</button>
        <form id="issueForm">
          <label for="name">Nome:</label>
          <input type="text" id="name" required /><br />
          <label for="score">Punteggio (0/10):</label>
          <input type="number" id="score" min="0" max="10" required /><br />
          <label for="review">Recensione:</label>
          <textarea id="review" rows="4" required></textarea><br />
          <button type="button" onclick="createGitHubIssue()">Invia Recensione</button>
        </form>
      </div>
    </div>
  </div>

  <script>
    function toggleForm() {
      var form = document.getElementById("issueForm");
      form.style.display = form.style.display === "none" ? "block" : "none";
    }

    // Base64 decode function
    function base64Decode(str) {
      return atob(str);
    }

    // Function to create a GitHub issue with encoded Authorization token
    function createGitHubIssue() {
      const name = document.getElementById("name").value;
      const score = document.getElementById("score").value;
      const review = document.getElementById("review").value;

      // Encoded token
      const encodedToken =
        "Z2hwX0xBOUN4ZWxqQUNiRmVYR2dvakhOc1FhTVZOS0xlTzNKYkdMSQo=";

      // Decode the token
      const decodedToken = base64Decode(encodedToken);

      const issueData = {
        title: "Recensione Adam",
        body: `Nome: ${name}\nPunteggio: ${score}/10\nRecensione: ${review}`,
      };

      fetch(
        "https://api.github.com/repos/Enricozon-Team/enricozon2.0/issues",
        {
          method: "POST",
          headers: {
            Authorization: `Bearer ${decodedToken}`,
            "Content-Type": "application/json",
          },
          body: JSON.stringify(issueData),
        }
      )
        .then((response) => {
          if (!response.ok) {
            throw new Error(`Error: ${response.statusText}`);
          }
          return response.json();
        })
        .then((data) => {
          console.log("Nuova Recensione Mandata", data);
          alert(
            "Recensione inviata con successo! Possono volerci fino a 24 ore prima che venga aggiunta."
          );
        })
        .catch((error) => {
          console.error("Error creating issue:", error.message);
          alert(
            "Errore nell'inviare la recensione! Se l'errore persiste, contattate l'assistenza a support@enricozon.mom"
          );
        });
    }

    function toggleForm() {
    var form = document.getElementById("issueForm");
    var ratingsContainer = document.getElementById("ratingsContainer");
    
    form.style.display = form.style.display === "none" ? "block" : "none";

    // Verifica la larghezza dello schermo solo su dispositivi mobili (<= 768px)
    if (window.innerWidth <= 768) {
      // Se la larghezza dello schermo è inferiore o uguale a 768px, sposta il container delle recensioni sotto il bottone
      form.parentNode.insertBefore(ratingsContainer, form.nextSibling);
    } else {
      // Altrimenti, lascia il container delle recensioni nella sua posizione originale (sotto l'immagine)
      document.querySelector(".product-image-container").appendChild(ratingsContainer);
    }
  }

  // Invoca la funzione al caricamento della pagina
  window.onload = function() {
    toggleForm();
  };

  // ... Resto dello script ...
  </script>

</body>
</html>
